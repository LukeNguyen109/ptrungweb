<!--Author: Phu Trung Nguyen
    Date: OCT 2025
    Description: táº¡o quÃ  sn á»§n ngu
-->
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Main menu1</title>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@500&display=swap" rel="stylesheet">
  <style>
    body {
      /* background: radial-gradient(circle at center, #1b0034, #000); */
        background-image: url("static/CreasedPaper.jpg"); /* ÄÆ°á»ng dáº«n Ä‘áº¿n áº£nh ná»n */
        background-size: cover;       /* áº¢nh phá»§ toÃ n mÃ n hÃ¬nh */
        background-position: center;  /* CÄƒn giá»¯a áº£nh */
        background-repeat: no-repeat; /* KhÃ´ng láº·p láº¡i */
        font-family: 'Quicksand', sans-serif;
        color: white;
        text-align: center;
        height: 100vh;
        margin: 0;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    h1 {
      font-size: 4em;
      text-shadow: 0 0 15px #ff66ff;
      margin-bottom: 30px;
    }

    button {
      font-size: 1.5em;
      padding: 10px 25px;
      margin: 10px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background-color: #ff66cc;
      color: white;
      box-shadow: 0 0 15px #ff99ff;
      transition: all 0.3s ease;
    }

    button:hover {
      background-color: #ff3399;
      transform: scale(1.1);
    }

    #message-box {
      background: rgba(0, 0, 0, 0.7);
      padding: 20px 40px;
      border-radius: 15px;
      box-shadow: 0 0 20px #ff66ff;
      display: none;
      flex-direction: column;
      align-items: center;
    }

    #message-box p {
      font-size: 1.5em;
      margin-bottom: 20px;
      color: #ffb3ff;
    }

    #angry-pig {
      width: 180px;
      height: auto;
      margin-bottom: 20px;
      animation: shake 0.8s infinite;
    }

    @keyframes shake {
      0% { transform: rotate(0deg); }
      25% { transform: rotate(5deg); }
      50% { transform: rotate(0deg); }
      75% { transform: rotate(-5deg); }
      100% { transform: rotate(0deg); }
    }
    /* ğŸ· Heo cháº¡y ngang */
    .running-pig {
      position: fixed;
      left: -200px;
      width: 120px;
      height: auto;
      z-index: 10;
      animation: runAcross 6s linear forwards;
      pointer-events: none; /* khÃ´ng cáº£n trá»Ÿ báº¥m nÃºt */
    }

    @keyframes runAcross {
      0% { left: -200px; transform: scaleX(1); }
      50% { transform: scaleX(1); }
      100% { left: 110vw; transform: scaleX(1); }
    }
    #corner-pig {
      position: absolute;
      top: 10px;
      right: 85px;
      width: 100px;
      height: auto;
      z-index: 2000;
      animation: pigFadeIn 1s ease-out;
    }

    @keyframes pigFadeIn {
      from { opacity: 0; transform: translateX(50px); }
      to { opacity: 1; transform: translateX(0); }
    }

    /* ğŸ· Heo bay tung ra tá»« bá»©c thÆ° */
    .flying-pig {
      position: fixed;
      width: 120px;
      height: auto;
      z-index: 1500;
      transform: translate(-50%, -50%) scale(0.8);
      animation: pigExplosion 3s ease-out forwards;
      pointer-events: none;
    }

    @keyframes pigExplosion {
      0% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(
          calc(-50% + (randX * 1px)),
          calc(-50% + (randY * 1px))
        ) scale(0.6);
      }
    }



  </style>
</head>
<body>
  <!-- Music permission popup -->
<div id="music-popup" style="
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.55);
  display: flex; align-items: center; justify-content: center;
  z-index: 5000;
">
  <div style="
    width: min(420px, 90vw);
    background: rgba(0,0,0,0.75);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 16px;
    padding: 18px 18px 14px;
    box-shadow: 0 0 24px rgba(255, 102, 255, 0.25);
    text-align: center;
  ">
    <div style="display:flex; justify-content: space-between; align-items:center;">
      <div style="font-size: 1.1em; color:#ffb3ff;">má»Ÿ tiáº¿ng nheğŸ«°ğŸ» </div>
      <button id="music-close" aria-label="Close" style="
        background: transparent; border: none; color:#ff66a3;
        font-size: 1.2em; cursor: pointer;
      ">âœ–</button>
    </div>

    <p style="margin: 12px 0 16px; color:#fff; opacity:0.9;">
      Ä‘á»ƒ khá»i cháº·n autoplay Ã¡, chá»‰nh volume coi chá»«ng Ä‘iáº¿c
    </p>

    <button id="music-yes" style="
      font-size: 1.1em;
      padding: 10px 18px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background-color: #ff66cc;
      color: white;
      box-shadow: 0 0 15px #ff99ff;
    ">kÃª</button>
  </div>
</div>
<!-- Date quiz popup -->
<div id="date-popup" style="
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.55);
  display: none;
  align-items: center; justify-content: center;
  z-index: 5500;
">
  <div style="
    width: min(420px, 90vw);
    background: rgba(0,0,0,0.78);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 16px;
    padding: 18px 18px 14px;
    box-shadow: 0 0 24px rgba(255, 102, 255, 0.25);
    text-align: center;
  ">
    <div style="display:flex; justify-content: space-between; align-items:center;">
      <div style="font-size: 1.1em; color:#ffb3ff;">tháº¿ ngÃ y gÃ¬ nÃ³i coi ğŸ˜¼</div>
      <button id="date-close" aria-label="Close" style="
        background: transparent; border: none; color:#ff66a3;
        font-size: 1.2em; cursor: pointer;
      ">âœ–</button>
    </div>

    <p style="margin: 12px 0 10px; color:#fff; opacity:0.9;">
      hÃ£y nháº­p Ä‘Ãºng Ä‘á»ƒ Ä‘Æ°á»£c nháº­n quÃ  ğŸ
    </p>

    <input id="date-input" inputmode="numeric" placeholder="nháº­p dÃ´ Ä‘Ã¢y nÃ¨ cu" style="
      width: 70%;
      font-size: 1.1em;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.25);
      outline: none;
      text-align: center;
    " />

    <div id="date-error" style="margin-top:10px; color:#ff8fb3; display:none;">
      sai rá»“i ğŸ˜’ nháº­p láº¡i Ä‘i
    </div>

    <div style="margin-top: 14px;">
      <button id="date-submit">OK</button>
    </div>
  </div>
</div>

<!-- Congrats popup -->
<div id="congrats-popup" style="
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.55);
  display: none;
  align-items: center; justify-content: center;
  z-index: 5600;
">
  <div style="
    width: min(420px, 90vw);
    background: rgba(0,0,0,0.78);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 16px;
    padding: 18px 18px 16px;
    box-shadow: 0 0 24px rgba(255, 102, 255, 0.25);
    text-align: center;
  ">
    <div style="font-size: 1.15em; color:#ffb3ff; margin-bottom: 10px;">
      ThÃ´ng minh Ä‘áº¥y ğŸ˜<br> Trong 5s pháº£i click vÃ o con heo Ä‘á»ƒ nháº­n quÃ 
    </div>

    <div style="
      font-size: 3.2em;
      font-weight: 700;
      color: #fff;
      text-shadow: 0 0 18px #ff66ff;
      margin: 10px 0 4px;
    " id="countdown">5</div>

    <div style="color:#fff; opacity:0.85; margin-top: 6px;">
      Ä‘áº¿m ngÆ°á»£c xÃ­u nha...
    </div>
  </div>
</div>
<!-- ğŸ’¬ Feedback popup 1 -->
<div id="feedback1-popup" style="
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.55);
  display: none;
  align-items: center; justify-content: center;
  z-index: 5700;
">
  <div style="
    width: min(520px, 92vw);
    background: rgba(0,0,0,0.78);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 16px;
    padding: 18px 18px 16px;
    box-shadow: 0 0 24px rgba(255, 102, 255, 0.25);
    text-align: center;
    font-family: 'Quicksand', sans-serif;
  ">
    <div style="display:flex; justify-content: space-between; align-items:flex-start;">
      <div style="font-size: 1.05em; color:#ffb3ff; text-align:left; line-height:1.4;">
        hehe láº§n Ä‘áº§u lÃ m web nÃªn k bt design xá»‹n xÃ²<br>
        cho xin tÃ­ chia sáº» nho
      </div>
      <button id="feedback1-close" aria-label="Close" style="
        background: transparent; border: none; color:#ff66a3;
        font-size: 1.2em; cursor: pointer;
      ">âœ–</button>
    </div>

    <textarea id="feedback1-input" rows="4" placeholder="gÃµ gÃ¬ Ä‘Ã³ rá»“i nháº¥n Enter..."
      style="
        width: 92%;
        margin-top: 12px;
        font-size: 1.05em;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid rgba(255,255,255,0.25);
        outline: none;
        resize: none;
      "></textarea>

    <div style="margin-top: 10px; color:#fff; opacity:0.8; font-size:0.95em;">
      (Enter Ä‘á»ƒ gá»­i â€¢ Shift+Enter Ä‘á»ƒ xuá»‘ng dÃ²ng)
    </div>
    <div style="margin-top: 14px;">
      <button id="feedback1-ok" style="
        font-size: 1.05em;
        padding: 10px 18px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        background-color: #ff66cc;
        color: white;
        box-shadow: 0 0 15px #ff99ff;
      ">Gá»­i cho pt</button>
    </div>
  </div>
</div>

<!-- ğŸ˜­ No-server popup 2 -->
<div id="feedback2-popup" style="
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.55);
  display: none;
  align-items: center; justify-content: center;
  z-index: 5800;
">
  <div style="
    width: min(520px, 92vw);
    background: rgba(0,0,0,0.78);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 16px;
    padding: 18px 18px 16px;
    box-shadow: 0 0 24px rgba(255, 102, 255, 0.25);
    text-align: center;
    font-family: 'Quicksand', sans-serif;
  ">
    <div style="font-size: 1.05em; color:#ffb3ff; line-height:1.5; margin-bottom: 12px;">
      dá»¡n thÃ´i chá»© t Ä‘ cÃ³ server Ä‘á»ƒ coi láº¡i Ä‘Ã¢u kkk,<br>
      muá»‘n nÃ³i gÃ¬ thÃ¬ ig: <b>phutrungdeptraidangcapvcl</b>
    </div>

    <button id="feedback2-ok" style="
      font-size: 1.05em;
      padding: 10px 18px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background-color: #ff66cc;
      color: white;
      box-shadow: 0 0 15px #ff99ff;
    ">OK</button>
  </div>
</div>

<!-- ğŸ‘€ Tab title popup 3 -->
<div id="feedback3-popup" style="
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.55);
  display: none;
  align-items: center; justify-content: center;
  z-index: 5900;
">
  <div style="
    width: min(520px, 92vw);
    background: rgba(0,0,0,0.78);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 16px;
    padding: 18px 18px 16px;
    box-shadow: 0 0 24px rgba(255, 102, 255, 0.25);
    text-align: center;
    font-family: 'Quicksand', sans-serif;
  ">
    <div style="display:flex; justify-content: space-between; align-items:center;">
      <div style="font-size: 1.05em; color:#ffb3ff;">
        btw náº¿u m k Ä‘á»ƒ Ã½ thÃ¬ nhÃ¬n tÃªn tab Ä‘i
      </div>
      <button id="feedback3-close" aria-label="Close" style="
        background: transparent; border: none; color:#ff66a3;
        font-size: 1.2em; cursor: pointer;
      ">âœ–</button>
    </div>
  </div>
</div>


  <h1>Ãª á»§n biáº¿t nay ngÃ y gÃ¬ kh cu?</h1>
  <div id="menu">
    <button id="yes">CÃ³ ğŸ˜</button>
    <button id="no">KhÃ´ng ğŸ˜’</button>
  </div>

  <div id="message-box">
    <img id="angry-pig" src="static/angryPig.gif" alt="Angry Pig">
    <p>m tá»‡ vcl ğŸ˜¤ chá»n "CÃ³" Ä‘i Ä‘á»“ ngu ğŸ˜¡</p>
    <button id="ok">OK ğŸ™„</button>
  </div>

<script>
  const yesBtn = document.getElementById("yes");
  const noBtn = document.getElementById("no");
  const okBtn = document.getElementById("ok");
  const menu = document.getElementById("menu");
  const messageBox = document.getElementById("message-box");
  const fb1Ok = document.getElementById("feedback1-ok");

  
  // =======================
  // AUDIO SETUP
  // =======================
  const track1 = new Audio("static/1.mp3");
  const track2 = new Audio("static/2.mp3");
  const trackNo = new Audio("static/saomayngutheha.mp3");

  //  loop thÃ¬ báº­t
  track1.loop = true;
  track2.loop = false;
  trackNo.loop = false;
  trackNo.playsInline = true;

  trackNo.addEventListener("ended", () => {
    play1();
  });
  track2.addEventListener("ended", () => {
    play1();
  });

  // iOS hay cáº§n play inline
  track1.playsInline = true;
  track2.playsInline = true;

  function stopAll() {
  [track1, track2, trackNo].forEach(a => {
    a.pause();
    a.currentTime = 0;
  });
}

  async function playTrack(audio) {
    try {
      await audio.play();
    } catch (e) {
      // náº¿u váº«n bá»‹ cháº·n (hiáº¿m), Ã­t nháº¥t khÃ´ng crash
      console.warn("Audio play blocked:", e);
    }
  }

  function play1() { stopAll(); playTrack(track1); }
  function play2() { stopAll(); playTrack(track2); }

  // =======================
  // ğŸµ MUSIC POPUP (anti-autoplay-block)
  // =======================
  const musicPopup = document.getElementById("music-popup");
  const musicYes = document.getElementById("music-yes");
  const musicClose = document.getElementById("music-close");

  // Má»Ÿ trang -> hiá»‡n popup (máº·c Ä‘á»‹nh Ä‘Ã£ hiá»‡n báº±ng style)
  // Báº¥m "CÃ³" trong popup -> phÃ¡t 1.mp3
  musicYes.addEventListener("click", () => {
    musicPopup.style.display = "none";
    play1();
  });

  // Báº¥m âœ– popup -> táº¯t nháº¡c (hoáº·c báº¡n muá»‘n váº«n phÃ¡t thÃ¬ tuá»³)
  musicClose.addEventListener("click", () => {
    musicPopup.style.display = "none";
    stopAll();
  });

  // =======================
// ğŸ’¬ FEEDBACK POPUPS FLOW
// =======================
const fb1Popup = document.getElementById("feedback1-popup");
const fb1Input = document.getElementById("feedback1-input");
const fb1Close = document.getElementById("feedback1-close");

const fb2Popup = document.getElementById("feedback2-popup");
const fb2Ok = document.getElementById("feedback2-ok");

const fb3Popup = document.getElementById("feedback3-popup");
const fb3Close = document.getElementById("feedback3-close");

function showFeedback1() {
  fb1Popup.style.display = "flex";
  fb1Input.value = "";
  setTimeout(() => fb1Input.focus(), 0);
}

function hideFeedback1() {
  fb1Popup.style.display = "none";
}

function showFeedback2() {
  fb2Popup.style.display = "flex";
}

function hideFeedback2() {
  fb2Popup.style.display = "none";
}

function showFeedback3() {
  fb3Popup.style.display = "flex";
  document.title = "ptrung dcap vcl á»§n thÃ¬ nerd";
}

function hideFeedback3() {
  fb3Popup.style.display = "none";
  // âœ… quay vá» menu chÃ­nh
  menu.style.display = "block";
  messageBox.style.display = "none";
}

// Close popup 1 -> bá» qua luÃ´n vÃ  quay vá» menu
fb1Close.addEventListener("click", () => {
  hideFeedback1();
  menu.style.display = "block";
});

// Enter Ä‘á»ƒ gá»­i (Shift+Enter Ä‘á»ƒ xuá»‘ng dÃ²ng)
fb1Input.addEventListener("keydown", (e) => {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    hideFeedback1();
    showFeedback2();
  }
});

fb1Ok.addEventListener("click", () => {
  hideFeedback1();
  showFeedback2();
});

fb2Ok.addEventListener("click", () => {
  hideFeedback2();
  showFeedback3();
}); 

fb3Close.addEventListener("click", () => {
  hideFeedback3();
});


  // Khi báº¥m "CÃ³" â†’ Hiá»‡n bá»©c thÆ°
  function openLetter() {
    const letterBox = document.createElement("div");
    letterBox.innerHTML = `
      <div id="letter-container">
        <div id="letter">
          <button id="close-letter">âœ–</button>
          <div class="scrollable">
            <h3>Happy birthday á»§n nho ğŸ‚</h3>
            <p>HÃ´m nay lÃ  má»™t ngÃ y tháº­t Ä‘áº·c biá»‡t â€” ngÃ y mÃ  tháº¿ giá»›i trá»Ÿ nÃªn tÆ°Æ¡i sÃ¡ng hÆ¡n má»™t chÃºt, vÃ¬ cÃ³ báº¡n trong Ä‘Ã³.</p>
            <p>ChÃºc báº¡n cÃ³ má»™t sinh nháº­t trÃ n Ä‘áº§y niá»m vui, tiáº¿ng cÆ°á»i vÃ  háº¡nh phÃºc. Cáº£m Æ¡n báº¡n vÃ¬ Ä‘Ã£ luÃ´n lÃ  chÃ­nh mÃ¬nh â€” áº¥m Ã¡p, Ä‘Ã¡ng yÃªu vÃ  chÃ¢n thÃ nh.</p>
            <p>Mong ráº±ng má»—i ngÃ y trÃ´i qua Ä‘á»u mang Ä‘áº¿n cho báº¡n nhá»¯ng Ä‘iá»u tuyá»‡t vá»i, nhá»¯ng ká»· niá»‡m Ä‘Ã¡ng nhá»› vÃ  ná»¥ cÆ°á»i tháº­t tÆ°Æ¡i.</p>
            <p>ThÃªm má»™t tuá»•i má»›i tháº­t rá»±c rá»¡ nhÃ©! ğŸ’—              keke</p>
          </div>
        </div>
      </div>
    `;
    document.body.appendChild(letterBox);

        // ğŸ©· Heo ná»• tung liÃªn tá»¥c tá»« mÃ©p bá»©c thÆ°
        function spawnHeartPigs() {
          const pigs = ["static/cute-pig.webp", "static/love-squeeze.webp"];
          const letter = document.getElementById("letter");

          if (!letter) return;

          for (let i = 0; i < 3; i++) {  // sá»‘ lÆ°á»£ng má»—i Ä‘á»£t burst
            const pig = document.createElement("img");
            pig.src = pigs[Math.floor(Math.random() * pigs.length)];
            pig.className = "flying-pig";

            // Láº¥y kÃ­ch thÆ°á»›c & vá»‹ trÃ­ cá»§a bá»©c thÆ°
            const rect = letter.getBoundingClientRect();
            const side = Math.floor(Math.random() * 4); // 0: top, 1: right, 2: bottom, 3: left
            let startX, startY;

            if (side === 0) { // trÃªn
              startX = rect.left + Math.random() * rect.width;
              startY = rect.top;
            } else if (side === 1) { // pháº£i
              startX = rect.right;
              startY = rect.top + Math.random() * rect.height;
            } else if (side === 2) { // dÆ°á»›i
              startX = rect.left + Math.random() * rect.width;
              startY = rect.bottom;
            } else { // trÃ¡i
              startX = rect.left;
              startY = rect.top + Math.random() * rect.height;
            }

            pig.style.left = `${startX}px`;
            pig.style.top = `${startY}px`;
            document.body.appendChild(pig);

            // HÆ°á»›ng bay ngáº«u nhiÃªn
            const angle = Math.random() * 2 * Math.PI;
            const distance = 200 + Math.random() * 150;
            const x = Math.cos(angle) * distance;
            const y = Math.sin(angle) * distance;

            pig.animate(
              [
                { opacity: 1, transform: "translate(0, 0) scale(1)" },
                { opacity: 0, transform: `translate(${x}px, ${y}px) scale(0.6)` }
              ],
              { duration: 2500, easing: "ease-out", fill: "forwards" }
            );

            setTimeout(() => pig.remove(), 2500);
          }
        }
        const burstInterval = setInterval(spawnHeartPigs, 800); // cá»© 0.8s ná»• 1 Ä‘á»£t

    // ğŸ· Hiá»‡n heo á»Ÿ gÃ³c pháº£i khi má»Ÿ thÆ°
    const cornerPig = document.createElement("img");
    cornerPig.src = "static/unlaclu.webp"; // hoáº·c chá»‰nh Ä‘Æ°á»ng dáº«n náº¿u khÃ¡c
    cornerPig.id = "corner-pig";
    letterBox.querySelector("#letter").appendChild(cornerPig);


    // CSS popup
    if (!document.getElementById("letter-style")) {
      const style = document.createElement("style");
      style.textContent = `
        #letter-container {
          position: fixed;
          top: 0; left: 0;
          width: 100vw; height: 100vh;
          background: rgba(0,0,0,0.4);
          display: flex;
          justify-content: center;
          align-items: center;
          z-index: 999;
        }

        #letter {
          width: 500px;
          max-height: 75vh;
          background: #fff;
          border-radius: 20px;
          box-shadow: 0 0 25px rgba(255,180,200,0.5);
          padding: 120px 50px 40px 60px; /* top right bottom left */
          text-align: left;
          font-family: 'Quicksand', sans-serif;
          position: relative;
          background-image: url('static/cutePigFrame.jpg');
          background-size: 100% 100%;
          background-position: center;
          background-repeat: no-repeat;
          animation: fadeIn 0.6s ease-out;
        }

        #letter h2 {
          text-align: center;
          color: #ff6699;
          font-family: 'Dancing Script', cursive;
          margin-bottom: 5px;
        }

        #letter h3 {
          text-align: center;
          color: #ff4da6;
          margin-bottom: 15px;
          font-size: 1.2em;
        }

        .scrollable {
          overflow-y: auto;
          max-height: 48vh;
          padding-right: 10px;
          margin-top: 10px;
        }

        #letter p {
          color: #333;
          font-size: 1.05em;
          line-height: 1.6;
          margin-bottom: 15px;
          text-align: left;     /* cÄƒn trÃ¡i ná»™i dung */
          margin-left: 15px;    /* Ä‘áº©y nháº¹ chá»¯ vÃ o trong Ä‘á»ƒ khÃ´ng sÃ¡t khung */
          margin-right: 15px;   /* giá»¯ khoáº£ng Ä‘á»u hai bÃªn */
        }

        #close-letter {
          position: absolute;
          top: 12px; right: 18px;
          background: transparent;
          border: none;
          font-size: 1.2em;
          cursor: pointer;
          color: #ff66a3;
          transition: 0.3s;
        }

        #close-letter:hover {
          transform: scale(1.2);
          color: #ff3399;
        }

        @keyframes fadeIn {
          from {opacity: 0; transform: scale(0.8);}
          to {opacity: 1; transform: scale(1);}
        }

        /* Thanh cuá»™n má»m máº¡i */
        .scrollable::-webkit-scrollbar {
          width: 6px;
        }
        .scrollable::-webkit-scrollbar-thumb {
          background: #ffcce0;
          border-radius: 10px;
        }
      `;
      document.head.appendChild(style);
    }

    // NÃºt Ä‘Ã³ng popup
    document.getElementById("close-letter").addEventListener("click", () => {
      clearInterval(burstInterval);
      letterBox.remove();
      const cornerPig = document.getElementById("corner-pig");
      if (cornerPig) cornerPig.remove();
      play1();
      showFeedback1();
    });
}
const datePopup = document.getElementById("date-popup");
const dateInput = document.getElementById("date-input");
const dateSubmit = document.getElementById("date-submit");
const dateClose = document.getElementById("date-close");
const dateError = document.getElementById("date-error");
const congratsPopup = document.getElementById("congrats-popup");
const countdownEl = document.getElementById("countdown");
let countdownTimer = null;

function showCongratsThenOpenLetter() {
  // Ä‘Ã³ng popup nháº­p
  datePopup.style.display = "none";

  // hiá»‡n popup chÃºc má»«ng
  congratsPopup.style.display = "flex";

  // reset countdown
  let n = 5;
  countdownEl.textContent = String(n);

  // clear timer cÅ© náº¿u cÃ³
  if (countdownTimer) clearInterval(countdownTimer);

  countdownTimer = setInterval(() => {
    n -= 1;
    countdownEl.textContent = String(n);

    if (n <= 0) {
      clearInterval(countdownTimer);
      countdownTimer = null;
      congratsPopup.style.display = "none";
      openLetter(); // âœ… sau 5 giÃ¢y má»›i má»Ÿ thÆ°
    }
  }, 1000);
}

function normaliseDate(s) {
  s = (s || "").trim().replace(/[-.]/g, "/");
  if (/^\d{4}$/.test(s)) s = s.slice(0,2) + "/" + s.slice(2);

  const m = s.match(/^(\d{1,2})\/(\d{1,2})$/);
  if (!m) return s;

  const dd = String(parseInt(m[1], 10)).padStart(2, "0");
  const mm = String(parseInt(m[2], 10)).padStart(2, "0");
  return `${dd}/${mm}`;
}
function normaliseText(s) {
  return (s || "")
    .toLowerCase()
    .normalize("NFD")                 // tÃ¡ch dáº¥u
    .replace(/[\u0300-\u036f]/g, "")  // xoÃ¡ dáº¥u
    .trim();
}

function submitDate() {
  const correctAnswers = [
    "14/01",
    "sn bo",
    "sn tao",
    "sn un",
    "sinh nhat un",
    "sinh nhat bo"
  ];

  const raw = dateInput.value;
  const vDate = normaliseDate(raw);
  const vText = normaliseText(raw);

  if (correctAnswers.includes(vDate) || correctAnswers.includes(vText)) {
    play2();  
    showCongratsThenOpenLetter();   
  } else {
    dateError.style.display = "block";
    dateInput.focus();
    dateInput.select();
  }
}


dateSubmit.addEventListener("click", submitDate);
dateInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") submitDate();
});
dateClose.addEventListener("click", () => {
  datePopup.style.display = "none";
});
datePopup.addEventListener("click", (e) => {
  if (e.target === datePopup) datePopup.style.display = "none";
});

yesBtn.addEventListener("click", () => {
  // má»Ÿ popup há»i ngÃ y
  document.getElementById("date-popup").style.display = "flex";
  document.getElementById("date-error").style.display = "none";
  const inp = document.getElementById("date-input");
  inp.value = "";
  inp.focus();
});
  // NÃºt "KhÃ´ng" vÃ  "OK" giá»¯ nguyÃªn
  noBtn.addEventListener("click", () => {
    stopAll();
    playTrack(trackNo);
    menu.style.display = "none";
    messageBox.style.display = "flex";
  });
  okBtn.addEventListener("click", () => {
    messageBox.style.display = "none";
    menu.style.display = "block";
    // play1();
  });
</script>
<script>
  // ğŸ· HÃ m táº¡o con heo cháº¡y ngang
  function spawnRunningPig(forceAtTitle = false) {
    const pig = document.createElement("img");
    pig.src = "static/runningPig.gif";
    pig.className = "running-pig";

    // náº¿u lÃ  láº§n Ä‘áº§u tiÃªn â†’ Ä‘áº·t Ä‘Ãºng vá»‹ trÃ­ dÃ²ng tiÃªu Ä‘á»
    if (forceAtTitle) {
      const title = document.querySelector("h1");
      const titleRect = title.getBoundingClientRect();
      const topPosition = titleRect.top + titleRect.height / 2; // giá»¯a dÃ²ng chá»¯
      pig.style.top = topPosition + "px";
    } else {
      // cÃ¡c láº§n sau thÃ¬ random
      const randomTop = Math.random() * 70 + 10; // tá»« 10% Ä‘áº¿n 80% mÃ n hÃ¬nh
      pig.style.top = randomTop + "%";
    }

    document.body.appendChild(pig);

    // tá»± xÃ³a sau khi cháº¡y qua
    setTimeout(() => pig.remove(), 6000);
  }

  // Khi táº£i trang xong thÃ¬ cháº¡y 1 láº§n ngang qua dÃ²ng chá»¯,
  // sau Ä‘Ã³ cá»© má»—i 4 giÃ¢y láº¡i cháº¡y ngáº«u nhiÃªn
  window.addEventListener("load", () => {
    spawnRunningPig(true); // cháº¡y Ä‘áº§u tiÃªn ngang qua dÃ²ng chá»¯
    setInterval(spawnRunningPig, 6000); // sau Ä‘Ã³ má»—i 6 giÃ¢y
  });
</script>


</body>
</html>
